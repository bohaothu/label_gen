
@article{Akerborg19299507,
	author = {Akerborg, O. and Sennblad, B. and Arvestad, L. and Lagergren, J.},
	title = {Simultaneous Bayesian gene tree reconstruction and reconciliation analysis.},
	journal = {Proc Natl Acad Sci U S A},
	volume = {106},
	number = {14},
	year = {2009},
	month = {Apr},
	pages = {5714-5719},
	pmid = {19299507},
	doi = {10.1073/pnas.0806251106},
	abstract = {We present GSR, a probabilistic model integrating gene duplication,
sequence evolution, and a relaxed molecular clock for substitution
rates, that enables genomewide analysis of gene families. The
gene duplication and loss process is a major cause for incongruence
between gene and species tree, and deterministic methods have
been developed to explain such differences through tree reconciliations.
Although probabilistic methods for phylogenetic inference have
been around for decades, probabilistic reconciliation methods
are far less established. Based on our model, we have implemented
a Bayesian analysis tool, PrIME-GSR, for gene tree inference that
takes a known species tree into account. Our implementation is
sound and we demonstrate its utility for genomewide gene-family
analysis by applying it to recently presented yeast data. We validate
PrIME-GSR by comparing with previous analyses of these data that
take advantage of gene order information. In a case study we apply
our method to the ADH gene family and are able to draw biologically
relevant conclusions concerning gene duplications creating key
yeast phenotypes. On a higher level this shows the biological
relevance of our method. The obtained results demonstrate the
value of a relaxed molecular clock. Our good performance will
extend to species where gene order conservation is insufficient.}
}

@article{ArvestadJACM09,
 author = {Arvestad, Lars and Lagergren, Jens and Sennblad, Bengt},
 title = {The gene evolution model and computing its associated probabilities},
 journal = {J. ACM},
 volume = {56},
 number = {2},
 year = {2009},
 issn = {0004-5411},
 pages = {1--44},
 doi = {http://doi.acm.org/10.1145/1502793.1502796},
 publisher = {ACM},
 address = {New York, NY, USA},
 abstract = {
Phylogeny is both a fundamental tool in biology and a rich source of
fascinating modeling and algorithmic problems. Today's wealth of
sequenced genomes makes it increasingly important to understand
evolutionary events such as duplications, losses, transpositions,
inversions, lateral transfers, and domain shuffling. We focus on the
gene duplication event, that constitutes a major force in the creation
of genes with new function [Ohno 1970; Lynch and Force 2000] and,
thereby also, of biodiversity.

We introduce the probabilistic gene evolution model, which describes
how a gene tree evolves within a given species tree with respect to
speciation, gene duplication, and gene loss. The actual relation
between gene tree and species tree is captured by a reconciliation, a
concept which we generalize for more expressiveness. The model is a
canonical generalization of the classical linear birth-death process,
obtained by replacing the interval where the process takes place by a
tree.

For the gene evolution model, we derive efficient algorithms for some
associated probability distributions: the probability of a reconciled
tree, the probability of a gene tree, the maximum probability
reconciliation, the posterior probability of a reconciliation, and
sampling reconciliations with respect to the posterior
probability. These algorithms provides the basis for several
applications, including species tree construction, reconciliation
analysis, orthology analysis, biogeography, and host-parasite
co-evolution.
}
 }

@article{Akerborg18318893,
	author = {Akerborg, O. and Sennblad, B. and Lagergren, J.},
	title = {Birth-death prior on phylogeny and speed dating.},
	journal = {BMC Evol Biol},
	volume = {8},
	year = {2008},
	pages = {77},
	pmid = {18318893},
	doi = {10.1186/1471-2148-8-77},
	abstract = {BACKGROUND: In recent years there has been a trend of leaving
the strict molecular clock in order to infer dating of speciations
and other evolutionary events. Explicit modeling of substitution
rates and divergence times makes formulation of informative prior
distributions for branch lengths possible. Models with birth-death
priors on tree branching and auto-correlated or iid substitution
rates among lineages have been proposed, enabling simultaneous
inference of substitution rates and divergence times. This problem
has, however, mainly been analysed in the Markov chain Monte Carlo
(MCMC) framework, an approach requiring computation times of hours
or days when applied to large phylogenies. RESULTS: We demonstrate
that a hill-climbing maximum a posteriori (MAP) adaptation of
the MCMC scheme results in considerable gain in computational
efficiency. We demonstrate also that a novel dynamic programming
(DP) algorithm for branch length factorization, useful both in
the hill-climbing and in the MCMC setting, further reduces computation
time. For the problem of inferring rates and times parameters
on a fixed tree, we perform simulations, comparisons between hill-climbing
and MCMC on a plant rbcL gene dataset, and dating analysis on
an animal mtDNA dataset, showing that our methodology enables
efficient, highly accurate analysis of very large trees. Datasets
requiring a computation time of several days with MCMC can with
our MAP algorithm be accurately analysed in less than a minute.
From the results of our example analyses, we conclude that our
methodology generally avoids getting trapped early in local optima.
For the cases where this nevertheless can be a problem, for instance
when we in addition to the parameters also infer the tree topology,
we show that the problem can be evaded by using a simulated-annealing
like (SAL) method in which we favour tree swaps early in the inference
while biasing our focus towards rate and time parameter changes
later on. CONCLUSION: Our contribution leaves the field open for
fast and accurate dating analysis of nucleotide sequence data.
Modeling branch substitutions rates and divergence times separately
allows us to include birth-death priors on the times without the
assumption of a molecular clock. The methodology is easily adapted
to take data from fossil records into account and it can be used
together with a broad range of rate and substitution models.}
}



@article{Sennblad17484781,
	author = {Sennblad, B. and Schreil, E. and Berglund Sonnhammer, A.C. and Lagergren, J. and Arvestad, L.},
	title = {primetv: a viewer for reconciled trees.},
	journal = {BMC Bioinformatics},
	volume = {8},
	year = {2007},
	pages = {148},
	pmid = {17484781},
	doi = {10.1186/1471-2105-8-148},
	abstract = {BACKGROUND: Evolutionary processes, such as gene family evolution
or parasite-host co-speciation, can often be viewed as a tree
evolving inside another tree. Relating two given trees under such
a constraint is known as reconciling them. Adequate software tools
for generating illustrations of tree reconciliations are instrumental
for presenting and communicating results and ideas regarding these
phenomena. Available visualization tools have been limited to
illustrations of the most parsimonious reconciliation. However,
there exists a plethora of biologically relevant non-parsimonious
reconciliations. Illustrations of these general reconciliations
may not be achieved without manual editing. RESULTS: We have developed
a new reconciliation viewer, primetv. It is a simple and compact
visualization program that is the first automatic tool for illustrating
general tree reconciliations. It reads reconciled trees in an
extended Newick format and outputs them as tree-within-tree illustrations
in a range of graphic formats. Output attributes, such as colors
and layout, can easily be adjusted by the user. To enhance the
construction of input to primetv, two helper programs, readReconciliation
and reconcile, accompany primetv. Detailed examples of all programs'
usage are provided in the text. For the casual user a web-service
provides a simple user interface to all programs. CONCLUSION:
With primetv, the first visualization tool for general reconciliations,
illustrations of trees-within-trees are easy to produce. Because
it clarifies and accentuates an underlying structure in a reconciled
tree, e.g., the impact of a species tree on a gene-family phylogeny,
it will enhance scientific presentations as well as pedagogic
illustrations in an educational setting. primetv is available
at \verb+http://prime.sbc.su.se/primetv,+ both as a standalone
command-line tool and as a web service. The software is distributed
under the GNU General Public License.}
}

@inproceedings{arvestadrecomb04,
 author = {Arvestad, Lars and Berglund, Ann-Charlotte and Lagergren, Jens and Sennblad, Bengt},
 title = {Gene tree reconstruction and orthology analysis based on an integrated model for duplications and sequence evolution},
 booktitle = {RECOMB '04: Proceedings of the Eighth Annual International Conference on Research in Computational Molecular Biology},
 year = {2004},
 isbn = {1-58113-755-9},
 pages = {326--335},
 location = {San Diego, California, USA},
 doi = {http://doi.acm.org/10.1145/974614.974657},
 publisher = {ACM},
 address = {New York, NY, USA},
 abstract = {Gene tree and species tree reconstruction, orthology analysis and
reconciliation, are problems important in multigenome-based
comparative genomics and biology in general. In the present paper, we
advance the frontier of these areas in several respects and provide
important computational tools. First, exact algorithms are given for
several probabilistic reconciliation problems with respect to the
probabilistic gene evolution model, previously developed by the
authors. Until now, those problems were solved by MCMC estimation
algorithms. Second, we extend the gene evolution model to the gene
sequence evolution model, by including sequence evolution. Third, we
develop MCMC algorithms for the gene sequence evolution model that,
given gene sequence data allows: (1) orthology analysis,
reconciliation analysis, and gene tree reconstruction, w.r.t. a
species tree, that balances a likely/unlikely reconciliation and a
likely/unlikely gene tree and (2) species tree reconstruction that
balance a likely/unlikely reconciliation and a likely/unlikely gene
trees. These MCMC algorithms take advantage of the exact algorithms
for the gene evolution model. We have successfully tested our
dynamical programming algorithms on real data for a biogeography
problem. The MCMC algorithms perform very well both on synthetic and
biological data.
}
 }

@article{Arvestad12855432,
	author = {Arvestad, L. and Berglund, A.C. and Lagergren, J. and Sennblad, B.},
	title = {Bayesian gene/species tree reconciliation and orthology analysis using {MCMC}.},
	journal = {Bioinformatics},
	volume = {19 Suppl 1},
	year = {2003},
	pages = {i7-15},
	pmid = {12855432},
	abstract = {MOTIVATION: Comparative genomics in general and orthology analysis
in particular are becoming increasingly important parts of gene
function prediction. Previously, orthology analysis and reconciliation
has been performed only with respect to the parsimony model. This
discards many plausible solutions and sometimes precludes finding
the correct one. In many other areas in bioinformatics probabilistic
models have proven to be both more realistic and powerful than
parsimony models. For instance, they allow for assessing solution
reliability and consideration of alternative solutions in a uniform
way. There is also an added benefit in making model assumptions
explicit and therefore making model comparisons possible. For
orthology analysis, uncertainty has recently been addressed using
parsimonious reconciliation combined with bootstrap techniques.
However, until now no probabilistic methods have been available.
RESULTS: We introduce a probabilistic gene evolution model based
on a birth-death process in which a gene tree evolves 'inside'
a species tree. Based on this model, we develop a tool with the
capacity to perform practical orthology analysis, based on Fitch's
original definition, and more generally for reconciling pairs
of gene and species trees. Our gene evolution model is biologically
sound (Nei et al., 1997) and intuitively attractive. We develop
a Bayesian analysis based on MCMC which facilitates approximation
of an a posteriori distribution for reconciliations. That is,
we can find the most probable reconciliations and estimate the
probability of any reconciliation, given the observed gene tree.
This also gives a way to estimate the probability that a pair
of genes are orthologs. The main algorithmic contribution presented
here consists of an algorithm for computing the likelihood of
a given reconciliation. To the best of our knowledge, this is
the first successful introduction of this type of probabilistic
methods, which flourish in phylogeny analysis, into reconciliation
and orthology analysis. The MCMC algorithm has been implemented
and, although not yet being in its final form, tests show that
it performs very well on synthetic as well as biological data.
Using standard correspondences, our results carry over to allele
trees as well as biogeography.}
}
